[
  {
    "path": "/tree",
    "method": "POST",
    "summary": "Get DOM tree structure",
    "description": "Returns hierarchical view of page elements. Best for understanding page structure before interacting.\n\nResponse structure:\n  { tag, id?, classes?, attrs?, text?, value?, checked?, children?, flags?: { interactive, hidden, hasAria, ... } }\n\nFlags help identify interactive elements (buttons, inputs) and hidden content.\nForm inputs include live value/checked state (not just HTML attribute).\n\nUse ancestors:true to see parent elements when inspecting deep elements.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "selector": {
          "type": [
            "string",
            "null"
          ],
          "description": "Root element selector"
        },
        "depth": {
          "type": [
            "number",
            "null"
          ],
          "description": "Max depth (-1 = unlimited, default 3)"
        },
        "includeText": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Include text content (default true)"
        },
        "visibleOnly": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Only visible elements (default false)"
        },
        "pierceShadow": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Pierce shadow DOM (default true)"
        },
        "pierceFrames": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Pierce same-origin iframes (default true)"
        },
        "compact": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Minimal output (default false)"
        },
        "ancestors": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Include ancestor path from root (default false)"
        },
        "window": {
          "type": [
            "string",
            "null"
          ],
          "description": "Target window ID"
        }
      },
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/query",
    "method": "POST",
    "summary": "Query DOM elements by selector",
    "description": "Quick element lookup. Returns basic info: tagName, id, className, textContent, attributes.\n\nUse this to check if an element exists before clicking/typing. For detailed info, use /inspect instead.\n\nResponse: { tagName, id, className, textContent, attributes: {...} }",
    "inputSchema": {
      "type": "object",
      "properties": {
        "selector": {
          "type": "string",
          "description": "CSS selector"
        },
        "all": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Return all matches (default false = first only)"
        }
      },
      "required": [
        "selector"
      ],
      "additionalProperties": false
    }
  },
  {
    "path": "/inspect",
    "method": "POST",
    "summary": "Deep inspection of an element",
    "description": "Get everything about ONE element: geometry, computed styles, ARIA attributes, scroll position, visibility state.\n\nResponse includes:\n  - box: { x, y, width, height, visible }\n  - text: { innerText, value, placeholder }\n  - properties: { disabled, checked, hidden, role, ariaLabel, ... }\n  - styles: { display, visibility, opacity, ... } (curated subset)\n  - allStyles: { ...all computed styles } (only if fullStyles=true)\n  - matchedRules: [ { selector, source, specificity, properties } ] (only if matchedRules=true)\n  - hierarchy: { parent, children count, depth }\n\nUse before clicking to verify element is visible and enabled.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "selector": {
          "type": "string",
          "description": "CSS selector"
        },
        "fullStyles": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Include all computed styles (default: false)"
        },
        "matchedRules": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Include matched CSS rules with specificity (default: false)"
        },
        "window": {
          "type": [
            "string",
            "null"
          ],
          "description": "Target window ID"
        }
      },
      "required": [
        "selector"
      ],
      "additionalProperties": false
    }
  },
  {
    "path": "/inspectAll",
    "method": "POST",
    "summary": "Inspect multiple elements",
    "description": "Deep inspection of ALL elements matching selector (up to limit).\n\nSame detailed info as /inspect, but for multiple elements. Great for:\n  - Finding all buttons/links on a page\n  - Checking which form fields are required\n  - Listing all interactive elements\n\nResponse: array of inspection objects",
    "inputSchema": {
      "type": "object",
      "properties": {
        "selector": {
          "type": "string",
          "description": "CSS selector"
        },
        "limit": {
          "type": [
            "number",
            "null"
          ],
          "description": "Max elements (default 10)"
        },
        "fullStyles": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Include all computed styles (default: false)"
        },
        "matchedRules": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Include matched CSS rules with specificity (default: false)"
        },
        "window": {
          "type": [
            "string",
            "null"
          ],
          "description": "Target window ID"
        }
      },
      "required": [
        "selector"
      ],
      "additionalProperties": false
    }
  },
  {
    "path": "/find",
    "method": "POST",
    "summary": "Find elements by text content",
    "description": "Search for elements containing specific text. Saves writing querySelector + filter patterns.\n\nReturns first match by default, or all matches with all:true.\n\nResponse: { found: true, selector: \"...\", element: {...} } or { found: true, elements: [...] }",
    "inputSchema": {
      "type": "object",
      "properties": {
        "text": {
          "type": "string",
          "description": "Text to search for (substring match)"
        },
        "tag": {
          "type": [
            "string",
            "null"
          ],
          "description": "Limit to specific tag (button, a, div, etc)"
        },
        "exact": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Require exact text match (default false = substring)"
        },
        "all": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Return all matches (default false = first only)"
        },
        "visible": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Only visible elements (default true)"
        },
        "window": {
          "type": [
            "string",
            "null"
          ],
          "description": "Target window ID"
        }
      },
      "required": [
        "text"
      ],
      "additionalProperties": false
    }
  },
  {
    "path": "/form",
    "method": "POST",
    "summary": "Extract all form values as structured JSON",
    "description": "Get all form field values without needing to know the component's API.\n\nIntrospects forms and returns structured data:\n- Input values (text, email, password, etc.)\n- Checkbox/radio states\n- Select values (single and multiple)\n- Textarea content\n- Custom form elements with value property\n\nResponse: { fields: { name: value, ... }, form: { action, method, id } }\n\nWorks with standard forms and most framework components (React, Vue, etc).",
    "inputSchema": {
      "type": "object",
      "properties": {
        "selector": {
          "type": [
            "string",
            "null"
          ],
          "description": "Form selector (default: first form on page)"
        },
        "includeDisabled": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Include disabled fields (default false)"
        },
        "includeHidden": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Include hidden fields (default false)"
        },
        "window": {
          "type": [
            "string",
            "null"
          ],
          "description": "Target window ID"
        }
      },
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/click",
    "method": "POST",
    "summary": "Click an element",
    "description": "Scrolls element into view, then performs full click sequence: mouseenter, mouseover, mousedown, mouseup, click.\n\nTwo ways to target elements:\n- selector: CSS selector (traditional)\n- text + tag: Find by text content (more reliable for dynamic UIs)\n\nAutomatically fails if element is not found or is disabled. Check response.success to verify.\n\nWith diff:true, returns what changed after the click - added/removed elements, attribute changes, focus, scroll.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "selector": {
          "type": [
            "string",
            "null"
          ],
          "description": "CSS selector of element to click"
        },
        "text": {
          "type": [
            "string",
            "null"
          ],
          "description": "Text content to find (alternative to selector)"
        },
        "tag": {
          "type": [
            "string",
            "null"
          ],
          "description": "Tag name when using text (default: any clickable element)"
        },
        "diff": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Return DOM diff showing what changed after click (default false)"
        },
        "diffDelay": {
          "type": [
            "number",
            "null"
          ],
          "description": "Wait ms before capturing \"after\" state (default 100)"
        },
        "window": {
          "type": [
            "string",
            "null"
          ],
          "description": "Target window ID"
        }
      },
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/type",
    "method": "POST",
    "summary": "Type text into an element",
    "description": "Focus element and type text character by character with realistic event lifecycle.\n\nSimulates real user behavior:\n1. Focus via mouse click (default) or keyboard Tab\n2. Full keystroke events: keydown → beforeinput → input → keyup\n3. Fires change event on completion\n\nHandles native inputs, textareas, contenteditable, and framework-wrapped inputs (React, MUI, etc).\n\nOptions:\n- humanlike: Add realistic delays and occasional typos (default true)\n- focusMode: How to focus the element before typing\n  - \"mouse\" (default): Full mouse lifecycle (mouseenter → click → focus)\n  - \"keyboard\": Tab key navigation (for accessibility testing)\n  - \"direct\": Just .focus() (fast, for simple tests)\n- clear: Clear existing content before typing (default false)",
    "inputSchema": {
      "type": "object",
      "properties": {
        "selector": {
          "type": "string",
          "description": "CSS selector of input/textarea/contenteditable"
        },
        "text": {
          "type": "string",
          "description": "Text to type"
        },
        "humanlike": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Human-like delays and typos (default true)"
        },
        "focusMode": {
          "type": [
            "string",
            "null"
          ],
          "enum": [
            "mouse",
            "keyboard",
            "direct"
          ],
          "description": "How to focus: mouse (default), keyboard, or direct"
        },
        "clear": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Clear existing content before typing (default false)"
        },
        "blur": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Blur element after typing to trigger change event (default true)"
        },
        "typoRate": {
          "type": [
            "number",
            "null"
          ],
          "description": "Typo probability 0-1 (default 0.03)"
        },
        "minDelay": {
          "type": [
            "number",
            "null"
          ],
          "description": "Min ms between keys (default 50)"
        },
        "maxDelay": {
          "type": [
            "number",
            "null"
          ],
          "description": "Max ms between keys (default 150)"
        },
        "diff": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Return DOM diff showing what changed after typing (default false)"
        },
        "diffDelay": {
          "type": [
            "number",
            "null"
          ],
          "description": "Wait ms before capturing \"after\" state (default 100)"
        },
        "window": {
          "type": [
            "string",
            "null"
          ],
          "description": "Target window ID"
        }
      },
      "required": [
        "selector",
        "text"
      ],
      "additionalProperties": false
    }
  },
  {
    "path": "/drag",
    "method": "POST",
    "summary": "Drag from an element",
    "description": "Simulates drag gesture: mousedown on element, mousemove by delta, mouseup.\n\nGood for: sliders, resize handles, drag-and-drop reordering, range inputs.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "selector": {
          "type": "string",
          "description": "CSS selector of drag handle"
        },
        "deltaX": {
          "type": [
            "number",
            "null"
          ],
          "description": "Horizontal distance in pixels"
        },
        "deltaY": {
          "type": [
            "number",
            "null"
          ],
          "description": "Vertical distance in pixels"
        },
        "duration": {
          "type": [
            "number",
            "null"
          ],
          "description": "Drag duration in ms (default 300)"
        },
        "window": {
          "type": [
            "string",
            "null"
          ],
          "description": "Target window ID"
        }
      },
      "required": [
        "selector"
      ],
      "additionalProperties": false
    }
  },
  {
    "path": "/highlight",
    "method": "POST",
    "summary": "Visually highlight an element",
    "description": "Draw attention to an element with colored border and optional label.\n\nGreat for showing users what you found or pointing out issues. Use /unhighlight to remove.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "selector": {
          "type": "string",
          "description": "CSS selector"
        },
        "label": {
          "type": [
            "string",
            "null"
          ],
          "description": "Label text to show"
        },
        "color": {
          "type": [
            "string",
            "null"
          ],
          "description": "CSS color (default #6366f1)"
        },
        "duration": {
          "type": [
            "number",
            "null"
          ],
          "description": "Auto-hide after ms (omit for manual)"
        },
        "window": {
          "type": [
            "string",
            "null"
          ],
          "description": "Target window ID"
        }
      },
      "required": [
        "selector"
      ],
      "additionalProperties": false
    }
  },
  {
    "path": "/unhighlight",
    "method": "POST",
    "summary": "Remove highlight",
    "description": "Remove any active highlight overlay created by /highlight.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/scroll",
    "method": "POST",
    "summary": "Scroll to element or position",
    "description": "Smooth scroll with natural easing. Multiple modes:\n\n- selector: Scroll element into view (most common)\n- x/y: Scroll to absolute position\n- deltaX/deltaY: Scroll relative to current position\n\nAt least one of selector, x, y, deltaX, or deltaY must be provided.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "selector": {
          "type": [
            "string",
            "null"
          ],
          "description": "CSS selector to scroll into view"
        },
        "x": {
          "type": [
            "number",
            "null"
          ],
          "description": "Absolute X position in pixels"
        },
        "y": {
          "type": [
            "number",
            "null"
          ],
          "description": "Absolute Y position in pixels"
        },
        "deltaX": {
          "type": [
            "number",
            "null"
          ],
          "description": "Relative horizontal scroll in pixels"
        },
        "deltaY": {
          "type": [
            "number",
            "null"
          ],
          "description": "Relative vertical scroll in pixels"
        },
        "duration": {
          "type": [
            "number",
            "null"
          ],
          "description": "Animation duration in ms (default 500)"
        },
        "easing": {
          "type": [
            "string",
            "null"
          ],
          "description": "Easing function: ease-out (default), ease-in-out, linear"
        },
        "block": {
          "type": [
            "string",
            "null"
          ],
          "description": "Vertical alignment: center (default), start, end, nearest"
        },
        "window": {
          "type": [
            "string",
            "null"
          ],
          "description": "Target window ID"
        }
      },
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/wait",
    "method": "POST",
    "summary": "Wait for time, element, or condition",
    "description": "Flexible wait for async UI scenarios. Multiple modes:\n\n- ms: Wait for a fixed time (simple delay)\n- forElement: Poll until element appears (or disappears with hidden:true)\n- Both: Wait for element, then add extra ms delay\n\nAll modes support timeout (default 5000ms). Returns immediately if condition already met.\n\nResponse: { success: true, waited: ms, found?: boolean }",
    "inputSchema": {
      "type": "object",
      "properties": {
        "ms": {
          "type": [
            "number",
            "null"
          ],
          "description": "Milliseconds to wait"
        },
        "forElement": {
          "type": [
            "string",
            "null"
          ],
          "description": "CSS selector to wait for"
        },
        "hidden": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Wait for element to disappear (default false)"
        },
        "timeout": {
          "type": [
            "number",
            "null"
          ],
          "description": "Max wait time in ms (default 5000)"
        },
        "pollInterval": {
          "type": [
            "number",
            "null"
          ],
          "description": "Polling interval in ms (default 100)"
        },
        "window": {
          "type": [
            "string",
            "null"
          ],
          "description": "Target window ID"
        }
      },
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/navigate",
    "method": "POST",
    "summary": "Navigate to a URL",
    "description": "Navigate the browser to a new URL. Waits for page load to complete.\n\nUse /location after to verify navigation succeeded.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "url": {
          "type": "string",
          "description": "URL to navigate to"
        },
        "window": {
          "type": [
            "string",
            "null"
          ],
          "description": "Target window ID"
        }
      },
      "required": [
        "url"
      ],
      "additionalProperties": false
    }
  },
  {
    "path": "/refresh",
    "method": "POST",
    "summary": "Refresh the page",
    "description": "Reload the current page. Use hard: true to bypass cache.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "hard": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Bypass cache (default false)"
        },
        "window": {
          "type": [
            "string",
            "null"
          ],
          "description": "Target window ID"
        }
      },
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/location",
    "method": "GET",
    "summary": "Get current URL and title",
    "description": "Returns current page info.\n\nResponse: { url, title, pathname, search, hash }\n\nUse after /navigate to verify you're on the expected page."
  },
  {
    "path": "/mutations/watch",
    "method": "POST",
    "summary": "Start watching DOM mutations",
    "description": "Begin capturing DOM changes: elements added/removed, attributes changed, text modified.\n\nPresets filter out framework noise:\n- smart (default): Auto-detects React, Tailwind, etc.\n- minimal: Only element add/remove\n- none: Everything (noisy)\n\nGet captured mutations via /mutations/status.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "root": {
          "type": [
            "string",
            "null"
          ],
          "description": "Root selector to watch (default body)"
        },
        "childList": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Watch child additions/removals (default true)"
        },
        "attributes": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Watch attribute changes (default true)"
        },
        "characterData": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Watch text content changes (default false)"
        },
        "subtree": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Watch all descendants (default true)"
        },
        "debounce": {
          "type": [
            "number",
            "null"
          ],
          "description": "Debounce ms (default 100)"
        },
        "preset": {
          "type": [
            "string",
            "null"
          ],
          "description": "Filter preset: smart, xinjs, b8rjs, tailwind, react, minimal, none"
        },
        "filters": {
          "description": "Custom filter configuration",
          "type": [
            null,
            "null"
          ]
        },
        "pierceShadow": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Watch inside shadow DOM (default false)"
        }
      },
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/mutations/unwatch",
    "method": "POST",
    "summary": "Stop watching mutations",
    "description": "Stop capturing DOM mutations. Call this when done to free resources.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/mutations/status",
    "method": "GET",
    "summary": "Get mutation watch status",
    "description": "Check if mutation watching is active and get captured mutations.\n\nResponse: { watching: boolean, mutations: [...], summary: { added, removed, changed } }"
  },
  {
    "path": "/events/watch",
    "method": "POST",
    "summary": "Start watching semantic events",
    "description": "Begin capturing high-level user actions. Events are aggregated and meaningful:\n- \"user typed 'hello@example.com'\" not 18 keydown events\n- \"user clicked Submit\" not mousedown/mouseup/click\n\nPresets control verbosity:\n- minimal: clicks, submits, navigation only\n- interactive: + hovers on buttons, form changes (recommended)\n- detailed: + all element interactions\n- debug: everything\n\nCategories: interaction, navigation, input, hover, scroll, mutation, focus, console",
    "inputSchema": {
      "type": "object",
      "properties": {
        "preset": {
          "type": [
            "string",
            "null"
          ],
          "description": "Verbosity: minimal, interactive, detailed, debug"
        },
        "categories": {
          "type": [
            "array",
            "null"
          ],
          "items": {
            "type": "string"
          },
          "description": "Specific categories to watch"
        }
      },
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/events/unwatch",
    "method": "POST",
    "summary": "Stop watching events",
    "description": "Stop capturing semantic events. Events buffer is cleared.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/events",
    "method": "GET",
    "summary": "Get captured semantic events",
    "description": "Returns buffered events since watch started.\n\nResponse: { events: [{ type, timestamp, category, target?, payload }], since, count }\n\nEvent types: interaction:click, input:typed, navigation:navigate, hover:dwell, scroll:stop, etc."
  },
  {
    "path": "/events/stats",
    "method": "GET",
    "summary": "Get event aggregation statistics",
    "description": "Shows noise reduction metrics.\n\nResponse: { rawEvents, semanticEvents, reductionPercent, byCategory: {...} }\n\nTypically see 90%+ reduction (e.g., 2000 raw events → 80 semantic events)."
  },
  {
    "path": "/console",
    "method": "GET",
    "summary": "Get console output",
    "description": "Returns captured console.log/warn/error/info from the page.\n\nResponse: { entries: [{ level, message, timestamp, stack? }] }\n\nGreat for debugging - check for errors after actions fail."
  },
  {
    "path": "/eval",
    "method": "POST",
    "summary": "Execute JavaScript",
    "description": "Run arbitrary JavaScript in the browser context. Returns the result.\n\nThe code runs in the page's context with access to window, document, etc.\nReturn values are JSON-serialized. Promises are awaited.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "code": {
          "type": "string",
          "description": "JavaScript code to execute"
        },
        "window": {
          "type": [
            "string",
            "null"
          ],
          "description": "Target window ID"
        }
      },
      "required": [
        "code"
      ],
      "additionalProperties": false
    }
  },
  {
    "path": "/call",
    "method": "POST",
    "summary": "Call a method or get a property on an element",
    "description": "Call a method or access a property on an element by selector. Convenience wrapper around /eval.\n\nThis avoids writing querySelector boilerplate. Two modes:\n- With args (even empty []): Calls element.method(...args) \n- Without args: Returns element.property value\n\nReturn value is JSON-serialized. Promises are awaited.\n\nResponse: { success: true, data: <return value> }",
    "inputSchema": {
      "type": "object",
      "properties": {
        "selector": {
          "type": "string",
          "description": "CSS selector of the element"
        },
        "method": {
          "type": "string",
          "description": "Method name to call or property name to get"
        },
        "args": {
          "type": [
            "array",
            "null"
          ],
          "items": {},
          "description": "Arguments to pass (omit to get property value)"
        },
        "window": {
          "type": [
            "string",
            "null"
          ],
          "description": "Target window ID"
        }
      },
      "required": [
        "selector",
        "method"
      ],
      "additionalProperties": false
    }
  },
  {
    "path": "/screenshot",
    "method": "POST",
    "summary": "Capture a screenshot",
    "description": "Capture the page or a specific element as base64 PNG/WebP/JPEG.\n\nResponse: { success, image: \"data:image/png;base64,...\", width, height, source }\n\nSource indicates capture method: \"electron\" (best), \"html2canvas\", or \"viewport-only\".",
    "inputSchema": {
      "type": "object",
      "properties": {
        "selector": {
          "type": [
            "string",
            "null"
          ],
          "description": "Element to capture (omit for full page)"
        },
        "scale": {
          "type": [
            "number",
            "null"
          ],
          "description": "Scale factor (default 1)"
        },
        "maxWidth": {
          "type": [
            "number",
            "null"
          ],
          "description": "Max width in pixels"
        },
        "maxHeight": {
          "type": [
            "number",
            "null"
          ],
          "description": "Max height in pixels"
        }
      },
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/select/start",
    "method": "POST",
    "summary": "Start interactive selection",
    "description": "Let user drag to select a region on the page.\n\nAfter calling this, the user can draw a rectangle on the page.\nCall /select/result to get the elements within the selection.\n\nResponse: { success: true, message: \"Selection mode active\" }",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/select/cancel",
    "method": "POST",
    "summary": "Cancel selection mode",
    "description": "Exit selection mode without capturing. Use if user changed their mind.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/select/status",
    "method": "GET",
    "summary": "Check if selection is active",
    "description": "Check whether selection mode is currently active.\n\nResponse: { active: boolean, hasResult: boolean }"
  },
  {
    "path": "/select/result",
    "method": "GET",
    "summary": "Get selection result",
    "description": "After user completes selection, returns the region and elements within.\n\nResponse: { bounds: { x, y, width, height }, elements: [{ selector, tagName, text, ... }] }\n\nUse the selectors from this response in subsequent /click or /type calls."
  },
  {
    "path": "/select/clear",
    "method": "POST",
    "summary": "Clear selection result",
    "description": "Clear any stored selection result. Use before starting a new selection.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/windows",
    "method": "GET",
    "summary": "List connected windows",
    "description": "Returns all connected browser windows/tabs with IDs, URLs, and titles.\n\nResponse: { windows: [{ id, url, title, focused }] }\n\nUse window IDs in other endpoints (e.g., /click, /tree) to target specific tabs."
  },
  {
    "path": "/tabs/open",
    "method": "POST",
    "summary": "Open a new tab",
    "description": "Desktop app only. Opens a new tab with optional URL.\n\nIf url is omitted, opens a blank tab. The new tab gets the widget auto-injected.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "url": {
          "type": [
            "string",
            "null"
          ],
          "description": "URL to open"
        }
      },
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/tabs/close",
    "method": "POST",
    "summary": "Close a tab",
    "description": "Desktop app only. Closes the specified tab by window ID.\n\nGet window IDs from /windows endpoint.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "window": {
          "type": "string",
          "description": "Window ID to close"
        }
      },
      "required": [
        "window"
      ],
      "additionalProperties": false
    }
  },
  {
    "path": "/tabs/focus",
    "method": "POST",
    "summary": "Focus a tab",
    "description": "Desktop app only. Brings the specified tab to front.\n\nUseful when working with multiple tabs to ensure the right one is visible.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "window": {
          "type": "string",
          "description": "Window ID to focus"
        }
      },
      "required": [
        "window"
      ],
      "additionalProperties": false
    }
  },
  {
    "path": "/recording/start",
    "method": "POST",
    "summary": "Start recording user actions",
    "description": "Begin capturing user interactions as semantic events.\n\nThe recording captures clicks, typing, navigation, and more.\nUse /recording/stop to finish, then /recording/generate to create a test.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/recording/stop",
    "method": "POST",
    "summary": "Stop recording",
    "description": "Stop capturing user actions.\n\nResponse: { events: [...], duration: ms, eventCount: n }\n\nAfter stopping, use /recording/generate to convert events to a test.",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/recording/generate",
    "method": "POST",
    "summary": "Generate test from recording",
    "description": "Converts recorded semantic events into a JSON test file.\n\nThe generated test can be run with /test/run or saved for later use.\n\nResponse: { test: { version, name, url, steps: [...] } }",
    "inputSchema": {
      "type": "object",
      "properties": {
        "name": {
          "type": [
            "string",
            "null"
          ],
          "description": "Test name"
        }
      },
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/recordings",
    "method": "GET",
    "summary": "List saved recordings",
    "description": "List all saved recordings on the server.\n\nResponse: { recordings: [{ name, created, eventCount, duration }] }"
  },
  {
    "path": "/test/run",
    "method": "POST",
    "summary": "Run a JSON test",
    "description": "Execute a test defined in Haltija JSON format.\n\nTest structure:\n{\n  \"version\": 1,\n  \"name\": \"Login flow\",\n  \"url\": \"http://localhost:3000/login\",\n  \"steps\": [\n    { \"action\": \"type\", \"selector\": \"#email\", \"text\": \"user@example.com\" },\n    { \"action\": \"type\", \"selector\": \"#password\", \"text\": \"secret123\" },\n    { \"action\": \"click\", \"selector\": \"button[type=submit]\" },\n    { \"action\": \"assert\", \"assertion\": { \"type\": \"url\", \"pattern\": \"/dashboard\" } }\n  ]\n}\n\nStep actions: navigate, click, type, key, wait, assert, eval, verify\n\nOutput formats:\n- json: Structured result with step-by-step details\n- github: Annotations for GitHub Actions + markdown summary\n- human: Colored terminal output",
    "inputSchema": {
      "type": "object",
      "properties": {
        "test": {
          "description": "Test object with steps"
        },
        "format": {
          "type": [
            "string",
            "null"
          ],
          "enum": [
            "json",
            "github",
            "human"
          ],
          "description": "Output format: json (structured), github (annotations + summary), human (readable)"
        },
        "stepDelay": {
          "type": [
            "number",
            "null"
          ],
          "description": "Milliseconds between steps (default 100)"
        },
        "timeout": {
          "type": [
            "number",
            "null"
          ],
          "description": "Milliseconds timeout per step (default 5000)"
        },
        "stopOnFailure": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Stop on first failure (default true)"
        }
      },
      "required": [
        "test"
      ],
      "additionalProperties": false
    }
  },
  {
    "path": "/test/suite",
    "method": "POST",
    "summary": "Run multiple tests",
    "description": "Execute a suite of tests, optionally stopping on first failure.\n\nInput: { tests: [test1, test2, ...], format?, stopOnFailure? }\n\nResponse includes per-test results and overall summary.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "tests": {
          "type": "array",
          "items": {},
          "description": "Array of test objects"
        },
        "format": {
          "type": [
            "string",
            "null"
          ],
          "enum": [
            "json",
            "github",
            "human"
          ],
          "description": "Output format: json (structured), github (annotations + summary), human (readable)"
        },
        "testDelay": {
          "type": [
            "number",
            "null"
          ],
          "description": "Milliseconds between tests (default 500)"
        },
        "stepDelay": {
          "type": [
            "number",
            "null"
          ],
          "description": "Milliseconds between steps (default 100)"
        },
        "timeout": {
          "type": [
            "number",
            "null"
          ],
          "description": "Milliseconds timeout per step (default 5000)"
        },
        "stopOnFailure": {
          "type": [
            "boolean",
            "null"
          ],
          "description": "Stop on first failure (default false for suites)"
        }
      },
      "required": [
        "tests"
      ],
      "additionalProperties": false
    }
  },
  {
    "path": "/test/validate",
    "method": "POST",
    "summary": "Validate test without running",
    "description": "Check that a test is well-formed and all selectors exist on the current page.\n\nUse this to pre-check tests before running. Returns validation errors without executing steps.\n\nResponse: { valid: boolean, errors?: [{ step?, message }] }",
    "inputSchema": {
      "type": "object",
      "properties": {
        "test": {
          "description": "Test object to validate"
        }
      },
      "required": [
        "test"
      ],
      "additionalProperties": false
    }
  },
  {
    "path": "/snapshot",
    "method": "POST",
    "summary": "Capture page snapshot",
    "description": "Capture current page state for debugging.\n\nIncludes: DOM tree, console logs, viewport size, scroll position, URL, timestamp.\n\nResponse: { snapshot: { url, title, viewport, dom, console, timestamp } }\n\nGreat for debugging test failures - call this when something goes wrong.",
    "inputSchema": {
      "type": "object",
      "properties": {
        "trigger": {
          "type": [
            "string",
            "null"
          ],
          "description": "What triggered the snapshot (e.g., \"manual\", \"test-failure\")"
        },
        "context": {
          "description": "Additional context about the snapshot",
          "type": [
            null,
            "null"
          ]
        }
      },
      "required": [],
      "additionalProperties": false
    }
  },
  {
    "path": "/status",
    "method": "GET",
    "summary": "Server status",
    "description": "Returns server info and connected browser count.\n\nResponse: { version, uptime, browsers: n, focused?: windowId }\n\nUse to verify server is running and browsers are connected before testing."
  },
  {
    "path": "/version",
    "method": "GET",
    "summary": "Get server version",
    "description": "Returns the Haltija server version.\n\nResponse: { version: \"1.0.0\" }"
  },
  {
    "path": "/docs",
    "method": "GET",
    "summary": "Quick start guide",
    "description": "Human-readable getting started docs for AI agents.\n\nReturns markdown-formatted quick start guide with common workflows."
  },
  {
    "path": "/api",
    "method": "GET",
    "summary": "Full API reference",
    "description": "Complete API documentation with all endpoints.\n\nReturns structured JSON with all endpoints, their parameters, and examples."
  }
]